<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dylan's Dishes - Personalized Meal Plans</title>
    <style>
        /* (Keep all the same CSS styles from previous version) */
    </style>
</head>
<body>
    <!-- (Keep all the same HTML structure from previous version) -->

    <script>
        document.getElementById('meal-plan-form').addEventListener('submit', function(e) {
            e.preventDefault();
            generateMealPlan();
        });

        let usedMeals = {
            Breakfast: [],
            Lunch: [],
            Dinner: [],
            Snack: []
        };

        function generateMealPlan() {
            usedMeals = {
                Breakfast: [],
                Lunch: [],
                Dinner: [],
                Snack: []
            };

            const name = document.getElementById('name').value;
            const dietType = document.getElementById('diet-type').value;
            const calories = parseInt(document.getElementById('calories').value);
            const days = parseInt(document.getElementById('days').value);
            
            const includeBreakfast = document.getElementById('breakfast').checked;
            const includeLunch = document.getElementById('lunch').checked;
            const includeDinner = document.getElementById('dinner').checked;
            const includeSnacks = document.getElementById('snacks').checked;
            
            document.getElementById('plan-title').textContent = `${name}'s ${dietType.charAt(0).toUpperCase() + dietType.slice(1)} Meal Plan (${calories} kcal/day)`;
            
            const daysContainer = document.getElementById('days-container');
            daysContainer.innerHTML = '';
            
            for (let i = 1; i <= days; i++) {
                const dayContainer = document.createElement('div');
                dayContainer.className = 'day-container';
                dayContainer.innerHTML = `<h3 class="day-header">Day ${i}</h3>`;
                
                if (includeBreakfast) {
                    dayContainer.appendChild(createMealCard('Breakfast', i, dietType, calories));
                }
                if (includeLunch) {
                    dayContainer.appendChild(createMealCard('Lunch', i, dietType, calories));
                }
                if (includeDinner) {
                    dayContainer.appendChild(createMealCard('Dinner', i, dietType, calories));
                }
                if (includeSnacks) {
                    dayContainer.appendChild(createMealCard('Snack', i, dietType, calories));
                }
                
                daysContainer.appendChild(dayContainer);
            }
            
            document.getElementById('preferences-form').style.display = 'none';
            document.getElementById('meal-plan-results').style.display = 'block';
        }
        
        function createMealCard(mealType, day, diet, targetCalories) {
            const mealData = getUniqueMeal(mealType, diet, targetCalories);
            
            const mealCard = document.createElement('div');
            mealCard.className = 'meal-card';
            
            mealCard.innerHTML = `
                <span class="meal-type">${mealType}</span>
                <div class="meal-name">${mealData.name}</div>
                <div>${mealData.description}</div>
                <div class="meal-details" id="meal-${day}-${mealType.toLowerCase()}">
                    <h3>${mealData.name}</h3>
                    <p>${mealData.description}</p>
                    
                    <h4>Macros</h4>
                    <div class="macro-grid">
                        <div class="macro-item">
                            <div>Calories</div>
                            <div class="macro-value">${mealData.macros.calories}</div>
                        </div>
                        <div class="macro-item">
                            <div>Protein</div>
                            <div class="macro-value">${mealData.macros.protein}g</div>
                        </div>
                        <div class="macro-item">
                            <div>Carbs</div>
                            <div class="macro-value">${mealData.macros.carbs}g</div>
                        </div>
                        <div class="macro-item">
                            <div>Fat</div>
                            <div class="macro-value">${mealData.macros.fat}g</div>
                        </div>
                    </div>
                    
                    <h4>Ingredients</h4>
                    <ul>
                        ${mealData.ingredients.map(ing => `<li>${ing}</li>`).join('')}
                    </ul>
                    
                    <h4>Instructions</h4>
                    <div class="instructions">
                        <ol>
                            ${mealData.instructions.map(step => `<li>${step}</li>`).join('')}
                        </ol>
                    </div>
                </div>
            `;
            
            mealCard.addEventListener('click', function() {
                const details = this.querySelector('.meal-details');
                details.style.display = details.style.display === 'block' ? 'none' : 'block';
            });
            
            return mealCard;
        }
        
        function getUniqueMeal(mealType, diet, targetCalories) {
            // Get all possible meals for this type and diet
            const allMeals = getAllMealsForType(mealType, diet);
            
            // Filter by calories (within 20% of target)
            const calorieRange = [targetCalories * 0.8, targetCalories * 1.2];
            const suitableMeals = allMeals.filter(meal => 
                meal.macros.calories >= calorieRange[0] && 
                meal.macros.calories <= calorieRange[1] &&
                !usedMeals[mealType].includes(meal.name)
            );
            
            if (suitableMeals.length === 0) {
                // If no perfect matches, get closest available
                const fallbackMeals = allMeals.filter(meal => 
                    !usedMeals[mealType].includes(meal.name)
                );
                
                // Sort by calorie difference
                fallbackMeals.sort((a, b) => 
                    Math.abs(a.macros.calories - targetCalories) - 
                    Math.abs(b.macros.calories - targetCalories)
                );
                
                const selected = fallbackMeals[0];
                usedMeals[mealType].push(selected.name);
                return selected;
            }
            
            // Randomly select from suitable meals
            const selected = suitableMeals[Math.floor(Math.random() * suitableMeals.length)];
            usedMeals[mealType].push(selected.name);
            return selected;
        }
        
        function getAllMealsForType(mealType, diet) {
            // Expanded meal database with more options
            const meals = {
                'Breakfast': {
                    'balanced': [
                        {
                            name: "Avocado Toast with Eggs",
                            description: "Creamy avocado on whole grain toast with poached eggs",
                            macros: { calories: 450, protein: 18, carbs: 35, fat: 25 },
                            ingredients: ["2 slices whole grain bread", "1 ripe avocado", "2 eggs", "Salt and pepper"],
                            instructions: ["Toast bread", "Mash avocado", "Poach eggs", "Assemble and season"]
                        },
                        {
                            name: "Greek Yogurt Parfait",
                            description: "Yogurt with granola and fresh berries",
                            macros: { calories: 400, protein: 20, carbs: 45, fat: 15 },
                            ingredients: ["1 cup Greek yogurt", "1/2 cup granola", "1/2 cup mixed berries", "1 tbsp honey"],
                            instructions: ["Layer yogurt, granola and berries", "Drizzle with honey"]
                        },
                        {
                            name: "Oatmeal with Nuts",
                            description: "Steel-cut oats with almonds and banana",
                            macros: { calories: 500, protein: 15, carbs: 60, fat: 20 },
                            ingredients: ["1/2 cup steel-cut oats", "1 cup milk", "1/4 cup almonds", "1 banana"],
                            instructions: ["Cook oats in milk", "Top with sliced banana and almonds"]
                        }
                    ],
                    'keto': [
                        {
                            name: "Keto Pancakes",
                            description: "Fluffy almond flour pancakes with berries",
                            macros: { calories: 500, protein: 20, carbs: 10, fat: 40 },
                            ingredients: ["1 cup almond flour", "2 eggs", "1/4 cup almond milk", "1/2 cup berries"],
                            instructions: ["Mix ingredients", "Cook on griddle", "Serve with berries"]
                        },
                        {
                            name: "Bacon and Eggs",
                            description: "Classic keto breakfast with avocado",
                            macros: { calories: 600, protein: 25, carbs: 8, fat: 50 },
                            ingredients: ["3 strips bacon", "2 eggs", "1/2 avocado", "1 tbsp butter"],
                            instructions: ["Cook bacon", "Fry eggs in bacon fat", "Serve with sliced avocado"]
                        },
                        {
                            name: "Chia Pudding",
                            description: "Coconut milk chia pudding with nuts",
                            macros: { calories: 450, protein: 15, carbs: 12, fat: 35 },
                            ingredients: ["3 tbsp chia seeds", "1 cup coconut milk", "1/4 cup walnuts", "1 tsp vanilla"],
                            instructions: ["Mix chia and coconut milk", "Refrigerate overnight", "Top with nuts"]
                        }
                    ]
                },
                'Lunch': {
                    'balanced': [
                        {
                            name: "Quinoa Salad Bowl",
                            description: "Protein-packed quinoa with fresh vegetables",
                            macros: { calories: 550, protein: 22, carbs: 60, fat: 25 },
                            ingredients: ["1 cup cooked quinoa", "1/2 cup chickpeas", "1/2 cucumber", "1/2 cup cherry tomatoes"],
                            instructions: ["Combine ingredients", "Add dressing", "Toss and serve"]
                        },
                        {
                            name: "Turkey Wrap",
                            description: "Whole wheat wrap with turkey and veggies",
                            macros: { calories: 500, protein: 30, carbs: 45, fat: 20 },
                            ingredients: ["1 whole wheat wrap", "4 oz turkey", "1/4 avocado", "Lettuce and tomato"],
                            instructions: ["Layer ingredients on wrap", "Roll tightly", "Cut in half"]
                        },
                        {
                            name: "Salmon Salad",
                            description: "Grilled salmon over mixed greens",
                            macros: { calories: 600, protein: 40, carbs: 20, fat: 40 },
                            ingredients: ["6 oz salmon", "2 cups mixed greens", "1/4 cup feta", "1 tbsp olive oil"],
                            instructions: ["Grill salmon", "Toss greens with dressing", "Top with salmon and feta"]
                        }
                    ],
                    'keto': [
                        {
                            name: "Keto Chicken Caesar",
                            description: "Romaine with grilled chicken and keto dressing",
                            macros: { calories: 600, protein: 45, carbs: 8, fat: 45 },
                            ingredients: ["2 cups romaine", "6 oz chicken", "2 tbsp parmesan", "1/4 cup keto dressing"],
                            instructions: ["Grill chicken", "Chop romaine", "Combine with dressing and cheese"]
                        },
                        {
                            name: "Bunless Burger",
                            description: "Beef patty with cheese and bacon",
                            macros: { calories: 700, protein: 50, carbs: 5, fat: 55 },
                            ingredients: ["8 oz beef patty", "2 slices cheese", "2 strips bacon", "Lettuce wrap"],
                            instructions: ["Cook burger and bacon", "Melt cheese on patty", "Serve in lettuce wrap"]
                        },
                        {
                            name: "Zucchini Noodles",
                            description: "Zoodles with pesto and chicken",
                            macros: { calories: 550, protein: 40, carbs: 12, fat: 40 },
                            ingredients: ["2 zucchini", "1/2 cup pesto", "6 oz chicken", "1 tbsp olive oil"],
                            instructions: ["Spiralize zucchini", "Sauté with pesto", "Top with grilled chicken"]
                        }
                    ]
                },
                'Dinner': {
                    'balanced': [
                        {
                            name: "Salmon with Vegetables",
                            description: "Oven-baked salmon with roasted veggies",
                            macros: { calories: 650, protein: 40, carbs: 35, fat: 35 },
                            ingredients: ["6 oz salmon", "1 cup mixed vegetables", "1 tbsp olive oil", "Lemon"],
                            instructions: ["Roast salmon and veggies", "Drizzle with lemon"]
                        },
                        {
                            name: "Chicken Stir Fry",
                            description: "Chicken with vegetables and brown rice",
                            macros: { calories: 700, protein: 45, carbs: 60, fat: 25 },
                            ingredients: ["6 oz chicken", "2 cups veggies", "1/2 cup brown rice", "2 tbsp stir-fry sauce"],
                            instructions: ["Cook rice", "Stir-fry chicken and veggies", "Combine with sauce"]
                        },
                        {
                            name: "Vegetable Lasagna",
                            description: "Layered pasta with vegetables and cheese",
                            macros: { calories: 600, protein: 30, carbs: 55, fat: 30 },
                            ingredients: ["6 lasagna noodles", "1 cup ricotta", "2 cups veggies", "1 cup marinara"],
                            instructions: ["Layer ingredients", "Bake at 375°F for 45 min"]
                        }
                    ],
                    'keto': [
                        {
                            name: "Steak with Asparagus",
                            description: "Ribeye with roasted asparagus",
                            macros: { calories: 800, protein: 50, carbs: 10, fat: 65 },
                            ingredients: ["8 oz ribeye", "1 bunch asparagus", "2 tbsp butter", "Garlic"],
                            instructions: ["Sear steak", "Roast asparagus", "Serve with garlic butter"]
                        },
                        {
                            name: "Keto Pizza",
                            description: "Cauliflower crust pizza with toppings",
                            macros: { calories: 600, protein: 35, carbs: 12, fat: 45 },
                            ingredients: ["1 cauliflower crust", "1/2 cup sauce", "1 cup cheese", "Pepperoni"],
                            instructions: ["Top crust", "Bake at 400°F for 15 min"]
                        },
                        {
                            name: "Shrimp Scampi",
                            description: "Garlic butter shrimp over zucchini noodles",
                            macros: { calories: 650, protein: 40, carbs: 15, fat: 50 },
                            ingredients: ["12 oz shrimp", "2 zucchini", "4 tbsp butter", "Garlic and lemon"],
                            instructions: ["Sauté shrimp in butter", "Serve over zoodles"]
                        }
                    ]
                },
                'Snack': {
                    'balanced': [
                        {
                            name: "Yogurt with Nuts",
                            description: "Greek yogurt with almonds and honey",
                            macros: { calories: 300, protein: 15, carbs: 25, fat: 15 },
                            ingredients: ["1 cup Greek yogurt", "2 tbsp almonds", "1 tsp honey"],
                            instructions: ["Combine ingredients"]
                        },
                        {
                            name: "Apple with Peanut Butter",
                            description: "Sliced apple with natural peanut butter",
                            macros: { calories: 250, protein: 8, carbs: 30, fat: 12 },
                            ingredients: ["1 medium apple", "2 tbsp peanut butter"],
                            instructions: ["Slice apple", "Serve with peanut butter"]
                        },
                        {
                            name: "Hummus and Veggies",
                            description: "Fresh vegetables with hummus dip",
                            macros: { calories: 200, protein: 8, carbs: 20, fat: 10 },
                            ingredients: ["1/2 cup hummus", "1 cup carrot and celery sticks"],
                            instructions: ["Serve veggies with hummus"]
                        }
                    ],
                    'keto': [
                        {
                            name: "Cheese Roll-Ups",
                            description: "Sliced cheese wrapped with pepperoni",
                            macros: { calories: 350, protein: 20, carbs: 2, fat: 30 },
                            ingredients: ["2 oz cheese", "1 oz pepperoni"],
                            instructions: ["Roll pepperoni in cheese slices"]
                        },
                        {
                            name: "Keto Fat Bombs",
                            description: "Coconut oil and nut butter bites",
                            macros: { calories: 200, protein: 5, carbs: 3, fat: 20 },
                            ingredients: ["2 tbsp coconut oil", "2 tbsp almond butter", "1 tsp cocoa"],
                            instructions: ["Mix ingredients", "Freeze in molds"]
                        },
                        {
                            name: "Avocado Egg Salad",
                            description: "Mashed avocado with hard-boiled eggs",
                            macros: { calories: 400, protein: 15, carbs: 8, fat: 35 },
                            ingredients: ["1 avocado", "2 hard-boiled eggs", "1 tbsp mayo"],
                            instructions: ["Mash ingredients together"]
                        }
                    ]
                }
            };
            
            return meals[mealType][diet] || [];
        }
    </script>
</body>
</html>
    </script>
</body>
</html>
